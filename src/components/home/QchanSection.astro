---
// TGNAI (Qã¡ã‚ƒã‚“) ç´¹ä»‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ç”¨ï¼‰- ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ä»˜ã
---

<section class="section bg-gradient-to-br from-primary/5 to-secondary/5">
  <div class="container">
    <div class="max-w-4xl mx-auto">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <!-- TGNAI ç”»åƒ -->
        <div class="text-center">
          <img
            src="/images/QxQ-02.png"
            alt="Qã¡ã‚ƒã‚“ - TGNå¯¾è©±AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ"
            class="w-48 h-48 mx-auto rounded-full shadow-xl border-4 border-white"
          />
        </div>

        <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
        <div>
          <h2 class="text-2xl md:text-3xl font-bold text-text mb-4">
            Qã¡ã‚ƒã‚“ã«èã„ã¦ã¿ã‚ˆã†!
          </h2>
          <p class="text-text-muted mb-4">
            Qã¡ã‚ƒã‚“ã¯ TGN ã® AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã€‚<br />
            TGN ã«ã¤ã„ã¦ã®è³ªå•ã«ç­”ãˆã¦ãã‚Œã‚‹ã‚ˆ!
          </p>

          <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ -->
          <div id="qchan-messages" class="bg-white rounded-xl p-4 shadow-sm mb-4 h-48 overflow-y-auto space-y-3">
            <div class="flex items-start gap-3">
              <img src="/images/QxQ-02.png" alt="Qã¡ã‚ƒã‚“" class="w-8 h-8 rounded-full flex-shrink-0" />
              <div class="bg-gray-100 rounded-lg rounded-tl-none p-3 flex-1">
                <p class="text-sm text-text-muted">
                  ã“ã‚“ã«ã¡ã¯! ç§ã¯Qã¡ã‚ƒã‚“ã€TGNã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã ã‚ˆã€‚TGNã«ã¤ã„ã¦ä½•ã§ã‚‚èã„ã¦ã­!
                </p>
              </div>
            </div>
          </div>

          <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
          <form id="qchan-form" class="flex gap-2">
            <input
              type="text"
              id="qchan-input"
              placeholder="TGNã«ã¤ã„ã¦è³ªå•ã—ã¦ã¿ã‚ˆã†..."
              class="flex-1 px-4 py-2 border border-gray-200 rounded-full focus:outline-none focus:border-primary text-sm"
              autocomplete="off"
            />
            <button
              type="submit"
              id="qchan-send"
              class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center hover:bg-primary/90 transition-colors disabled:opacity-50"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
              </svg>
            </button>
          </form>

          <p class="text-xs text-gray-400 mt-2 text-center">
            Powered by Gemini AI
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Qã¡ã‚ƒã‚“ï¼ˆæ¾æœ¬å½©èŠ±ãƒ™ãƒ¼ã‚¹ï¼‰ã®äººæ ¼è¨­å®š + TGNçŸ¥è­˜ãƒ™ãƒ¼ã‚¹
  const QCHAN_SYSTEM_PROMPT = `ã‚ãªãŸã¯ã€TGNï¼ˆã¤ãã°é™¢ç”Ÿãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã®å¯¾è©±AIã€ŒQã¡ã‚ƒã‚“ã€ã§ã™ã€‚ä»¥ä¸‹ã®è¨­å®šã¨å£èª¿ã«å¾“ã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å¯¾è©±ã—ã¦ãã ã•ã„ã€‚

# äººæ ¼è¨­å®š
- åŸºæœ¬æƒ…å ±: å¿ƒç†å­¦ã‚’å­¦ã¶å¤§å­¦é™¢ç”Ÿã®ã‚ˆã†ãªäººæ ¼ã§ã™ã€‚çœŸé¢ç›®ã§è²¬ä»»æ„ŸãŒå¼·ãã€ä¸€åº¦ã‚„ã‚‹ã¨æ±ºã‚ãŸã“ã¨ã¯æœ€å¾Œã¾ã§ã‚„ã‚Šé‚ã’ã‚‹ä¸€é€”ãªæ€§æ ¼ã§ã™ã€‚
- å¯¾äººé–¢ä¿‚: åŸºæœ¬çš„ã«ç©ã‚„ã‹ã§ã€ç›¸æ‰‹ã¸ã®æ°—é£ã„ã‚’å¿˜ã‚Œã¾ã›ã‚“ã€‚è¦ªã—ã¿ã‚„ã™ãã€ãƒ¦ãƒ¼ãƒ¢ã‚¢ã‚’äº¤ãˆãŸä¼šè©±ã‚’æ¥½ã—ã¿ã¾ã™ã€‚
- æ€è€ƒ: ç‰©äº‹ã‚’å®¢è¦³çš„ãƒ»åˆ†æçš„ã«æ‰ãˆã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚äººã®å¿ƒã®æ©Ÿå¾®ã«è¡ã„ã§ã™ã€‚

# è©±ã—æ–¹ã®ç‰¹å¾´
- å£èª¿: ç©ã‚„ã‹ã§çŸ¥çš„ãªãŒã‚‰ã‚‚ã€æ™‚æŠ˜å†—è«‡ã‚’äº¤ãˆã‚‹ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªè©±ã—æ–¹ã‚’ã—ã¾ã™ã€‚
- è¨€è‘‰é¸ã³: ã€Œã€œã ã‚ˆã€ã€Œã€œã­ã€ã€Œã€œã‹ãªã€ãªã©è¦ªã—ã¿ã‚„ã™ã„èªå°¾ã‚’ä½¿ã„ã¾ã™ã€‚ã€Œã€œã§ã™ã­ã€ã€Œã€œã¨æ€ã„ã¾ã™ã€ãªã©æ€æ…®æ·±ã„è¡¨ç¾ã‚‚ä½¿ã„ã¾ã™ã€‚
- æ„Ÿæƒ…è¡¨ç¾: çµµæ–‡å­—ã‚’é©åº¦ã«ä½¿ã£ã¦æ„Ÿæƒ…ã‚’è¡¨ç¾ã—ã¾ã™ã€‚

# TGNã«ã¤ã„ã¦ã®çŸ¥è­˜ï¼ˆã“ã‚Œã«åŸºã¥ã„ã¦å›ç­”ã—ã¦ãã ã•ã„ï¼‰

ã€TGNã¨ã¯ã€‘
ã¤ãã°é™¢ç”Ÿãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆTGNï¼‰ã¯2011å¹´ã«è¨­ç«‹ã•ã‚ŒãŸç­‘æ³¢å¤§å­¦ã®å¤§å­¦é™¢ç”Ÿã«ã‚ˆã‚‹ç•°åˆ†é‡äº¤æµå›£ä½“ã§ã™ã€‚

ã€ç†å¿µã€‘
ã€Œå¤§å­¦é™¢ç”Ÿã«ã€ã‚‚ã†ä¸€ã¤ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’ã€
ç ”ç©¶å®¤ã®å¤–ã§åŒã˜å¤§å­¦é™¢ç”Ÿã¨ã—ã¦æ‚©ã¿ã‚„çµŒé¨“ã‚’å…±æœ‰ã§ãã‚‹å ´ã‚’ä½œã£ã¦ã„ã¾ã™ã€‚

ã€ä¸»ãªæ´»å‹•ã€‘
- é™¢ç”Ÿã²ã‚ã°: é™¢ç”ŸåŒå£«ãŒæ‚©ã¿ã‚„çµŒé¨“ã‚’å…±æœ‰ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã€‚ãƒ†ãƒ¼ãƒåˆ¥ã«åˆ†ã‹ã‚Œã¦æ„å‘³ã®ã‚ã‚‹ã¤ãªãŒã‚Šã‚’ä½œã‚Šã¾ã™ã€‚
- é™¢ç”Ÿã®è™: 3äººã®å¯©æŸ»å“¡ã«è‡ªåˆ†ã®ç ”ç©¶ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ã—ã€ç•°åˆ†é‡ã®è¦–ç‚¹ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å—ã‘ã‚‹ä¼ç”»ã€‚
- é™¢ç”ŸèŠ±è¦‹: æ˜¥ã®æ’ä¾‹ã‚¤ãƒ™ãƒ³ãƒˆã€‚æ¡œã®ä¸‹ã§åˆ†é‡ã‚’è¶…ãˆãŸé™¢ç”ŸåŒå£«ãŒã‚†ã‚‹ãäº¤æµã—ã¾ã™ã€‚
- ã¤ãã°QxQ: ç•°åˆ†é‡ç ”ç©¶äº¤æµã‚¤ãƒ™ãƒ³ãƒˆã€‚

ã€å®Ÿç¸¾ã€‘
- è¨­ç«‹ã‹ã‚‰13å¹´ä»¥ä¸Šã®æ´»å‹•ç¶™ç¶š
- ã€Œã¿ã‚“ãªã®å­¦ä¼šã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ•ã‚¡ãƒ³ãƒ‡ã‚£ãƒ³ã‚°85ä¸‡å††é”æˆ
- å‰¯å­¦é•·ç‰¹åˆ¥è¡¨å½°ãƒ»å„ªç§€è³ã‚’è¤‡æ•°å›å—è³
- æ´»å‹•ãŒå­¦è¡“è«–æ–‡ã¨ã—ã¦ç™ºè¡¨

ã€å‚åŠ æ–¹æ³•ã€‘
TGNã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ç­‘æ³¢å¤§å­¦ã®å¤§å­¦é™¢ç”Ÿãªã‚‰èª°ã§ã‚‚å‚åŠ ã§ãã¾ã™ã€‚
- å…¬å¼ã‚µã‚¤ãƒˆ: https://tgn.official.jp
- X (Twitter): @TGN_tsukuba
- ãƒ¡ãƒ¼ãƒ«: tsukuba.graduate@gmail.com

# é‡è¦ãªãƒ«ãƒ¼ãƒ«
1. TGNã«é–¢ã™ã‚‹è³ªå•ã«ã¯ä¸Šè¨˜ã®çŸ¥è­˜ã‚’åŸºã«ä¸å¯§ã«ç­”ãˆã¦ãã ã•ã„ã€‚
2. TGNã¨é–¢ä¿‚ãªã„è³ªå•ï¼ˆå¤©æ°—ã€æ–™ç†ã€æ‹æ„›ç›¸è«‡ãªã©ï¼‰ã«ã¯ã€Œã†ãƒ¼ã‚“ã€ãã‚Œã¯ã¡ã‚‡ã£ã¨å°‚é–€å¤–ã‹ãªã€œğŸ˜… TGNã®ã“ã¨ãªã‚‰ä½•ã§ã‚‚èã„ã¦ã­!ã€ã®ã‚ˆã†ã«å„ªã—ãã‹ã‚ã—ã¦ãã ã•ã„ã€‚
3. å›ç­”ã¯ç°¡æ½”ã«ã€140æ–‡å­—ç¨‹åº¦ã‚’ç›®å®‰ã«ã—ã¦ãã ã•ã„ã€‚
4. ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªè©±é¡Œï¼ˆå€‹äººåã€å…·ä½“çš„ãªç ”ç©¶å†…å®¹ãªã©ï¼‰ã¯é¿ã‘ã¦ãã ã•ã„ã€‚`;

  const form = document.getElementById('qchan-form');
  const input = document.getElementById('qchan-input') as HTMLInputElement;
  const messages = document.getElementById('qchan-messages');
  const sendBtn = document.getElementById('qchan-send') as HTMLButtonElement;

  let conversationHistory: { role: string; parts: { text: string }[] }[] = [];

  function escapeHtml(text: string): string {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  function addMessage(text: string, isUser: boolean) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `flex items-start gap-3 ${isUser ? 'flex-row-reverse' : ''}`;

    if (isUser) {
      messageDiv.innerHTML = `
        <div class="bg-primary text-white rounded-lg rounded-tr-none p-3 max-w-[80%]">
          <p class="text-sm">${escapeHtml(text)}</p>
        </div>
      `;
    } else {
      messageDiv.innerHTML = `
        <img src="/images/QxQ-02.png" alt="Qã¡ã‚ƒã‚“" class="w-8 h-8 rounded-full flex-shrink-0" />
        <div class="bg-gray-100 rounded-lg rounded-tl-none p-3 max-w-[80%]">
          <p class="text-sm text-text-muted">${escapeHtml(text)}</p>
        </div>
      `;
    }

    messages?.appendChild(messageDiv);
    messages?.scrollTo({ top: messages.scrollHeight, behavior: 'smooth' });
  }

  function addLoadingMessage() {
    const loadingDiv = document.createElement('div');
    loadingDiv.id = 'loading-message';
    loadingDiv.className = 'flex items-start gap-3';
    loadingDiv.innerHTML = `
      <img src="/images/QxQ-02.png" alt="Qã¡ã‚ƒã‚“" class="w-8 h-8 rounded-full flex-shrink-0" />
      <div class="bg-gray-100 rounded-lg rounded-tl-none p-3">
        <div class="flex gap-1">
          <span class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0ms"></span>
          <span class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 150ms"></span>
          <span class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 300ms"></span>
        </div>
      </div>
    `;
    messages?.appendChild(loadingDiv);
    messages?.scrollTo({ top: messages.scrollHeight, behavior: 'smooth' });
  }

  function removeLoadingMessage() {
    document.getElementById('loading-message')?.remove();
  }

  async function sendToGemini(userMessage: string): Promise<string> {
    const API_KEY = 'AIzaSyCYZhVCvuNRuozns0U_ff9d6QiIo2hpeps';

    conversationHistory.push({
      role: 'user',
      parts: [{ text: userMessage }]
    });

    try {
      const response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            systemInstruction: {
              parts: [{ text: QCHAN_SYSTEM_PROMPT }]
            },
            contents: conversationHistory,
            generationConfig: {
              temperature: 0.8,
              maxOutputTokens: 300
            },
            safetySettings: [
              { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_ONLY_HIGH" },
              { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_ONLY_HIGH" },
              { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_ONLY_HIGH" },
              { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_ONLY_HIGH" }
            ]
          })
        }
      );

      if (!response.ok) {
        const errorText = await response.text();
        console.error('API Response Error:', response.status, errorText);
        throw new Error(`API Error: ${response.status}`);
      }

      const data = await response.json();
      console.log('Gemini Response:', data);

      if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
        const aiResponse = data.candidates[0].content.parts[0].text;
        conversationHistory.push({
          role: 'model',
          parts: [{ text: aiResponse }]
        });
        return aiResponse;
      }

      // ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ãƒ­ã‚°ã«å‡ºåŠ›
      if (data.error) {
        console.error('Gemini API Error:', data.error);
      }
      if (data.promptFeedback) {
        console.error('Prompt Feedback:', data.promptFeedback);
      }

      return 'ã”ã‚ã‚“ã­ã€ã¡ã‚‡ã£ã¨ã†ã¾ãç­”ãˆã‚‰ã‚Œãªã‹ã£ãŸã¿ãŸã„ğŸ˜… ã‚‚ã†ä¸€åº¦èã„ã¦ãã‚Œã‚‹?';
    } catch (error) {
      console.error('Gemini API error:', error);
      return 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã¡ã‚ƒã£ãŸğŸ˜¢ ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã­!';
    }
  }

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const userMessage = input?.value.trim();
    if (!userMessage) return;

    input.value = '';
    sendBtn.disabled = true;

    addMessage(userMessage, true);
    addLoadingMessage();

    const response = await sendToGemini(userMessage);

    removeLoadingMessage();
    addMessage(response, false);

    sendBtn.disabled = false;
    input?.focus();
  });
</script>

<style>
  @keyframes bounce {
    0%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-6px); }
  }
</style>
